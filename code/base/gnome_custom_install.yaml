# ============================================
# File that install Themes
# ============================================

---

# ============================================
# adicionando reposit√≥rios dos Themes
# ============================================
- name: THEMES - Add repositories
  become: true
  become_method: sudo
  apt_repository:
    repo: "{{ item.key }}"
    filename: "{{ item.value }}"
  loop:
    - {key: 'ppa:tista/adapta',value: "adapta_theme"}
    - {key: 'ppa:papirus/papirus',value: "adapta_icon_theme"}

# ============================================
# Instalando os Themes
# ============================================
- name: THEMES - installing
  become: yes
  apt:
    name: "{{ packages }}"
    state: present
  vars:
    packages:
      - adapta-gtk-theme
      - papirus-icon-theme

# ============================================
# Set Dash position do BOTTOM
# ============================================
- name: THEME - change Dash position
  shell: gsettings set org.gnome.shell.extensions.dash-to-dock dock-position BOTTOM

# ============================================
# Change Dash icon size to 20
# ============================================
- name: THEME - change dash icon size
  shell: gsettings set org.gnome.shell.extensions.dash-to-dock dash-max-icon-size 20

# ============================================
# Disable Trash icon on Desktop
# ============================================
- name: THEME - Disable Trash icon on Desktop
  shell: gsettings set org.gnome.nautilus.desktop trash-icon-visible false

# ============================================
# Disable Network Servers icon on Desktop
# ============================================
- name: THEME - Disable Network Servers icon on Desktop
  shell: gsettings set org.gnome.nautilus.desktop network-icon-visible false

# ============================================
# Disable Home folder icon on Desktop
# ============================================
- name: THEME - Disable Home folder on Desktop
  shell: gsettings set org.gnome.nautilus.desktop home-icon-visible false

# ============================================
# Disable Mounted Volumes icon on Desktop
# ============================================
- name: THEME - Disable Mounted Volumes icon on Desktop
  shell: gsettings set org.gnome.nautilus.desktop volumes-visible false

# ============================================
# Change control buttons to the left position
# ============================================
- name: THEME - Change control buttons to the left
  shell: gsettings set org.gnome.desktop.wm.preferences button-layout 'close,minimize,maximize:'

# ============================================
# Change 'show apps' button to the left
# ============================================
- name: THEME - Change 'show apps' button to the left
  shell: gsettings set org.gnome.shell.extensions.dash-to-dock show-apps-at-top true

# ============================================
# Copy the profile picture to $HOME/Pictures
# ============================================
- name: THEME - Copy user profile picture
  copy: 
    src: files/profile.jpg
    dest: /home/{{ user }}/Pictures/profile.jpg

# ============================================
# set profile picture
# ============================================
- name: THEME - Change user profile picture
  become: true
  become_method: sudo
  lineinfile:
    path: /var/lib/AccountsService/users/{{ user }}
    regexp: '^Icon='
    line: 'Icon=/home/{{ user }}/Pictures/profile.jpg'

# ============================================
# Copy the wallpaper to $HOME/Pictures
# ============================================
- name: THEME - Copy wallpaper file
  copy: 
    src: files/wallpaper.jpg
    dest: /home/{{ user }}/Pictures/wallpaper.jpg

# ============================================
# Set favorite-app in Dash
# ============================================
- name: THEME - Set Favorite apps in Dash
  shell: gsettings set org.gnome.shell favorite-apps "['org.gnome.Nautilus.desktop', 'google-chrome.desktop', 'terminator.desktop', 'spotify.desktop']"

# ============================================
# Set Wallpaper
# ============================================
- name: THEME - Set GNOME Wallpaper
  shell: gsettings set org.gnome.desktop.background picture-uri file:///home/{{ user }}/Pictures/wallpaper.jpg

# ============================================
# Build lock screen wallpaper
# ============================================
- name: THEME - Build the lockscreen wallpaper
  shell: convert /home/{{ user }}/Pictures/wallpaper.jpg -blur 0x8 /home/{{ user }}/Pictures/wallpaper_lockscreen.jpg

# ============================================
# Set Wallpaper in lockscreen
# ============================================
- name: THEME - Set GNOME Wallpaper lockscreen
  shell: gsettings set org.gnome.desktop.screensaver picture-uri file:///home/{{ user }}/Pictures/wallpaper_lockscreen.jpg

# ============================================
# Set theme to Adapta-Nokto
# ============================================
- name: THEME - set to Adapta
  shell: gsettings set org.gnome.desktop.interface gtk-theme "Adapta-Nokto"

# ============================================
# Download another icon theme from github
# ============================================
- name: THEME - Download Korla icon theme
  git:
    repo: https://github.com/bikass/korla.git
    dest: .temp_folder

# ============================================
# Creating $HOME/.icons folder
# ============================================
- name: THEME - Creating $HOME/.icons folder
  file:
    path: /home/{{ user }}/.icons
    state: directory

# ============================================
# THEME - Copying Korla files
# OBS: Using module 'shell' was faster than use 'copy' module
# ============================================
- name: THEME - Copying Korla files
  shell: cd .temp_folder && mv korla korla-light /home/{{ user }}/.icons

# ============================================
# Deleting temporary folder
# ============================================
- name: THEME - Deleting temporary folder
  file:
    state: absent
    path: ".temp_folder"

# ============================================
# Set icons-theme to Korla
# ============================================
- name: THEME - set icons theme Adapta
  shell: gsettings set org.gnome.desktop.interface icon-theme "Korla"


